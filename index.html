<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kintra — From listing to leads, faster</title>
  <meta name="description" content="Kintra helps real estate teams respond faster, structure conversations, and book more viewings — across WhatsApp and web.">
  <link rel="icon" href="data:,">
  <style>
    :root {
      --bg:#0b1220; --fg:#f5f7fb; --muted:#a9b3c6; --accent:#0ea5e9; --card:#121a2b;
      --border:#22304b; --pill:#111827;
    }
    * { box-sizing:border-box; }
    body {
      margin:0; font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
      color:var(--fg); background:radial-gradient(1200px 600px at 70% -10%, #16315b 0%, #0b1220 55%);
    }
    a { color:var(--accent); text-decoration:none; }
    .wrap { max-width:1100px; margin:0 auto; padding:24px 16px 80px; }
    header { display:flex; align-items:center; gap:12px; }
    header img { width:32px; height:32px; display:block; }
    header .brand { font-weight:700; letter-spacing:.2px; }

    .hero {
      display:grid; grid-template-columns:1.2fr .8fr; gap:24px; align-items:center; margin:32px 0 16px;
    }
    .h1 { font-size:clamp(28px, 3.6vw, 42px); line-height:1.15; margin:0 0 8px; font-weight:800; }
    .sub { color:var(--muted); margin:0 0 16px; }
    .cta { display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    .btn { padding:12px 16px; border-radius:10px; border:1px solid var(--accent); background:var(--accent); color:#fff; cursor:pointer; }
    .btn.ghost { background:transparent; color:var(--accent); }
    .panel {
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--border); border-radius:14px; padding:16px;
    }
    .grid { display:grid; gap:16px; grid-template-columns:repeat(3,1fr); margin:24px 0; }
    .card { background:var(--card); border:1px solid var(--border); border-radius:14px; padding:16px; }
    .muted { color:var(--muted); }
    label { display:block; margin:8px 0 6px; color:var(--muted); font-size:14px; }
    input, textarea, select {
      width:100%; padding:10px 12px; border-radius:10px; border:1px solid #2a3a57; background:#0e1729; color:var(--fg);
      outline:none;
    }
    input::placeholder, textarea::placeholder { color:#6b7280; }
    .two { display:grid; gap:12px; grid-template-columns:1fr 1fr; }
    footer { margin-top:40px; color:#9aa3b5; font-size:14px; border-top:1px solid var(--border); padding-top:16px; }

    @media (max-width:900px) {
      .hero { grid-template-columns:1fr; }
      .grid { grid-template-columns:1fr; }
      .two { grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- Header -->
    <header>
      <img src="./img/logo.png.png" alt="Kintra logo" onerror="this.style.display='none'">
      <div class="brand">Kintra</div>
    </header>

    <!-- Hero -->
    <section class="hero">
      <div>
        <h1 class="h1">From listing to leads, faster.</h1>
        <p class="sub">Kintra helps real estate teams respond faster, structure conversations, and book more viewings — across WhatsApp and web.</p>
        <div class="cta">
          <a class="btn" href="#pilot">Request Pilot Access</a>
          <a class="btn ghost" href="./deck.html" target="_blank" rel="noopener">View Live Deck</a>
          <a class="btn ghost" href="./deck/Kintra_PilotDeck_v1.pdf" target="_blank" rel="noopener">View Deck PDF</a>
        </div>
        <div class="grid">
          <div class="card">
            <strong>Faster responses</strong>
            <div class="muted">Structure and translate replies in seconds — fewer delays, more booked viewings.</div>
          </div>
          <div class="card">
            <strong>Nothing slips</strong>
            <div class="muted">Summaries + next-steps ensure every lead is nurtured, across WhatsApp and web.</div>
          </div>
          <div class="card">
            <strong>Pilot in 2–4 weeks</strong>
            <div class="muted">Lightweight setup, run with 3–5 live interactions, measure minutes saved.</div>
          </div>
        </div>
      </div>
      <div class="panel">
        <!-- WhatsApp preview mock -->
        <div style="font-weight:700; margin-bottom:8px;">WhatsApp Preview</div>
        <div style="background:#0f172a;border:1px solid #20304f;border-radius:12px;padding:12px;">
          <div style="color:#9fb3d9;font-size:12px;margin-bottom:6px">Today</div>
          <div style="display:flex;gap:8px;align-items:flex-end;margin-bottom:8px">
            <div style="max-width:80%;background:#0b5; color:#fff; padding:10px 12px;border-radius:12px 12px 4px 12px;">
              Buongiorno! Possiamo fissare una visita alle 17:00?
            </div>
          </div>
          <div style="display:flex;gap:8px;align-items:flex-end;justify-content:flex-end">
            <div style="max-width:80%;background:#111827; color:#e5e7eb; padding:10px 12px;border-radius:12px 12px 12px 4px;">
              Certo — confermato. A dopo!
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 10-second demo (kept simple) -->
    <section class="card" style="margin-top:16px">
      <h3 style="margin:0 0 8px">Try a 10-second demo</h3>
      <div class="two">
        <div>
          <label for="q">Type anything (IT/EN):</label>
          <input id="q" placeholder="es. ciao, vorrei visitare domani..." />
        </div>
        <div>
          <label>Result:</label>
          <div id="result" class="muted">Ready.</div>
        </div>
      </div>
      <div class="cta" style="margin-top:12px">
        <button class="btn" onclick="runDemo()">Run Demo</button>
      </div>
    </section>

    <!-- Pilot form -->
    <section id="pilot" class="card" style="margin-top:16px">
      <h3 style="margin:0 0 8px">Request Pilot Access</h3>
      <div class="two">
        <div>
          <label for="name">Name</label>
          <input id="name" placeholder="Alex Rossi">
        </div>
        <div>
          <label for="email">Work email</label>
          <input id="email" placeholder="alex.rossi@agency.it">
        </div>
      </div>
      <label for="flow">What’s your current workflow? (optional)</label>
      <textarea id="flow" rows="3" placeholder="Gestiamo gli ingressi su WhatsApp + email, vogliamo risposte più rapide…"></textarea>
      <div class="cta" style="margin-top:12px">
        <button class="btn" onclick="submitPilot()">Join Pilot Waitlist</button>
        <a class="btn ghost" href="mailto:pilot@kintra.xyz">Or email us</a>
      </div>
      <div id="pilot_status" class="muted" style="margin-top:8px">No spam. Limited early access.</div>
    </section>

    <!-- ===== WhatsApp (Meta demo) — Polished ===== -->
    <div class="card" style="max-width:1100px;margin:24px 0 0;padding:16px;">
      <h3 style="margin:0 0 8px">Send via WhatsApp (Meta demo)</h3>
      <p class="muted" style="margin:0 0 12px">Uses Meta Cloud API (test number) to send a real message.</p>

      <div class="two">
        <div>
          <label for="wa_to">Recipient phone (E.164):</label>
          <input id="wa_to" type="tel" value="+351912494525" placeholder="+3519XXXXXXXX">
        </div>
        <div>
          <label for="wa_text">Message:</label>
          <input id="wa_text" value="Ciao! Possiamo fissare una visita domani alle 17:00?" />
        </div>
      </div>

      <div class="cta" style="margin-top:12px">
        <button id="wa_send_btn" class="btn" onclick="sendViaWhatsApp()">Send WhatsApp</button>
        <button type="button" class="btn ghost"
                onclick="document.getElementById('wa_text').value='Ciao! Possiamo fissare una visita oggi alle 17:00?'">
          Use Italian template
        </button>
      </div>
      <div id="wa_status" class="muted" style="margin-top:10px"></div>
    </div>
    <!-- ===== /WhatsApp (Meta demo) ===== -->

    <footer>
      © 2025 Kintra. Pilot inquiries: <a href="mailto:pilot@kintra.xyz">pilot@kintra.xyz</a>
    </footer>
  </div>

  <script>
    // ===== Config =====
    const API_BASE   = 'https://kintra-api.founder-60b.workers.dev'.trim(); // your echo/mock worker (already working for demo box)
    const WA_BASE    = 'https://kintra-wa-meta.founder-60b.workers.dev'.trim(); // your Meta WA worker

    // ===== Helpers =====
    function setText(id, msg) { const el = document.getElementById(id); if (el) el.textContent = msg; }
    function sanitizePhone(v){ return (v||'').replace(/[^\d+]/g,''); }

    // ===== 10-second demo (kept as before) =====
    async function runDemo() {
      const q = (document.getElementById('q')?.value || '').trim() || 'ciao';
      setText('result','Running…');
      try {
        const res = await fetch(API_BASE + '/api/prompt', {
          method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ text: q })
        });
        const j = await res.json();
        setText('result', 'OK → received: ' + JSON.stringify(j));
      } catch(e) {
        setText('result', 'Error: ' + e.message);
      }
    }

    // ===== Pilot form (stub to email) =====
    async function submitPilot() {
      const name  = (document.getElementById('name')?.value || '').trim();
      const email = (document.getElementById('email')?.value || '').trim();
      const flow  = (document.getElementById('flow')?.value || '').trim();
      if (!name || !email) { setText('pilot_status','Please add name + work email.'); return; }
      // For now we just simulate success; later wire to KV/Sheets/Email
      setText('pilot_status','Thanks — we’ll be in touch within 24 hours.');
    }

    // ===== WhatsApp (Meta demo) =====
    function statusWA(msg){ setText('wa_status', msg); }

    async function sendViaWhatsApp(){
      try{
        const btn = document.getElementById('wa_send_btn');
        const to  = sanitizePhone(document.getElementById('wa_to')?.value || '');
        const text= (document.getElementById('wa_text')?.value || '').trim();

        if (!WA_BASE || !/^https?:\/\//.test(WA_BASE)) { statusWA('Worker URL not set.'); return; }
        if (!to.startsWith('+') || to.length < 8){ statusWA('Please enter a valid phone (E.164).'); return; }
        if (!text){ statusWA('Please enter a message.'); return; }

        statusWA('Sending…'); if (btn){ btn.disabled=true; btn.textContent='Sending…'; }

        const headers = new Headers(); headers.set('Content-Type','application/json');

        const res = await fetch(WA_BASE + '/api/wa', {
          method:'POST', headers, body: JSON.stringify({ to, text })
        });
        const raw = await res.text();
        let json; try{ json = JSON.parse(raw); } catch{ json = { ok:false, error:'Non-JSON response', raw }; }

        console.log('[WA SEND]', res.status, json);

        if (res.status === 401 || json?.status === 401){
          statusWA('Token expired — regenerate in Meta → Getting Started, then update META_TOKEN secret.');
        } else if (!res.ok || !json.ok){
          statusWA('Error: ' + (json?.error || ('HTTP ' + res.status)));
        } else {
          statusWA('Sent ✓ (ID: ' + (json.id || 'n/a') + ')');
        }
      } catch(e){
        statusWA('Error: ' + (e?.message || 'Unexpected error'));
      } finally {
        const btn = document.getElementById('wa_send_btn');
        if (btn){ btn.disabled=false; btn.textContent='Send WhatsApp'; }
      }
    }
  </script>
</body>
</html>
